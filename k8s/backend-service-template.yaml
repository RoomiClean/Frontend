# 백엔드 프로젝트에 추가할 Service 파일
# 위치: ~/Desktop/Project/cleanb/k8s/service.yaml
#
# 이 파일을 백엔드 프로젝트에 복사하여 사용하세요:
# cp k8s/backend-service-template.yaml ~/Desktop/Project/cleanb/k8s/service.yaml
# cd ~/Desktop/Project/cleanb
# kubectl apply -f k8s/service.yaml

apiVersion: v1
kind: Service
metadata:
  name: cleanb-service
  namespace: default
  labels:
    app: cleanb
spec:
  type: ClusterIP
  selector:
    app: cleanb  # deployment.yaml의 label과 동일해야 함
  ports:
    - name: http
      protocol: TCP
      port: 8080      # Service가 노출할 포트
      targetPort: 8080  # Container 포트 (deployment.yaml의 containerPort)

---
# 외부 접근이 필요한 경우 Ingress도 추가 (선택사항)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: cleanb-ingress
  namespace: default
  annotations:
    # CORS 설정 (프론트엔드와 다른 도메인인 경우)
    nginx.ingress.kubernetes.io/cors-allow-origin: "*"
    nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, PUT, DELETE, OPTIONS"
    nginx.ingress.kubernetes.io/cors-allow-headers: "DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization"
spec:
  rules:
  - host: api.your-domain.com  # 백엔드 API 도메인
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: cleanb-service
            port:
              number: 8080
